var M=(h,b,n)=>new Promise((c,l)=>{var g=d=>{try{_(n.next(d))}catch(p){l(p)}},k=d=>{try{_(n.throw(d))}catch(p){l(p)}},_=d=>d.done?c(d.value):Promise.resolve(d.value).then(g,k);_((n=n.apply(h,b)).next())});import{g as W}from"./statistics-CFWEnhwS.js";import{g as A}from"./websites-BB6tL7tq.js";import{v as H,r as C,h as R,i as j,c as S,o as y,J as t,I as q,V as F,H as G,S as a,b as s,G as r,M as J,N as K,T as x,aa as P,R as m,ay as z,_ as Q}from"./index-Be-y8iif.js";const $={class:"welcome"},O={class:"flex flex-wrap items-center gap-4"},X={class:"flex items-center gap-2"},Z={class:"flex items-center gap-2"},ee={class:"flex items-center gap-2"},te={class:"flex items-center justify-between"},se={class:"text-base font-semibold"},ae={class:"mb-6"},le={class:"text-center"},oe={class:"text-2xl font-semibold",style:{color:"#67c23a"}},ne={class:"mb-6"},re={class:"text-center"},de={class:"text-2xl font-semibold",style:{color:"#e6a23c"}},ie={class:"mb-4"},ue={class:"text-4xl font-semibold",style:{color:"#67c23a"}},_e={class:"mb-4"},me={class:"text-4xl font-semibold",style:{color:"#409eff"}},ce=H({name:"Welcome",__name:"index",setup(h){const b=C([]),n=R({website_id:"",date_from:"",date_to:""}),c=C(!1),l=C(null),g=[{text:"最近7天",value:()=>{const o=new Date,e=new Date;return e.setDate(e.getDate()-7),[e,o]}},{text:"最近30天",value:()=>{const o=new Date,e=new Date;return e.setDate(e.getDate()-30),[e,o]}},{text:"最近3个月",value:()=>{const o=new Date,e=new Date;return e.setMonth(e.getMonth()-3),[e,o]}}],k=()=>M(null,null,function*(){try{const o=yield A({status:"active"});o.success&&(b.value=o.data,o.data.length>0&&(n.website_id=o.data[0].id,_()))}catch(o){console.error("加载网站列表失败",o)}}),_=()=>M(null,null,function*(){if(!n.website_id){z.warning("请选择网站");return}c.value=!0;try{const o=yield W(n);o.success&&(l.value=o.data)}catch(o){z.error("加载统计数据失败")}finally{c.value=!1}}),d=()=>{_()},p=()=>{n.date_from="",n.date_to="",_()},w=o=>`${(o*100).toFixed(2)}%`;return j(()=>{k()}),(o,e)=>{const v=r("el-card"),I=r("el-option"),L=r("el-select"),E=r("el-date-picker"),N=r("el-button"),D=r("el-text"),Y=r("el-divider"),f=r("el-statistic"),i=r("el-col"),V=r("el-row"),B=r("el-progress"),T=r("el-empty"),U=P("loading");return y(),S("div",$,[t(v,{class:"mb-4"},{default:a(()=>e[3]||(e[3]=[s("div",{class:"text-center"},[s("h1",{class:"text-3xl font-bold text-gray-800 mb-2"}," 欢迎使用 FETCHLINK "),s("p",{class:"text-gray-500"},"网页链接爬虫系统")],-1)])),_:1,__:[3]}),t(v,{class:"mb-4"},{default:a(()=>[s("div",O,[s("div",X,[e[4]||(e[4]=s("span",{class:"text-sm whitespace-nowrap"},"网站",-1)),t(L,{modelValue:n.website_id,"onUpdate:modelValue":e[0]||(e[0]=u=>n.website_id=u),placeholder:"请选择网站",style:{width:"200px"}},{default:a(()=>[(y(!0),S(J,null,K(b.value,u=>(y(),F(I,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",Z,[e[5]||(e[5]=s("span",{class:"text-sm whitespace-nowrap"},"日期范围",-1)),t(E,{modelValue:n.date_from,"onUpdate:modelValue":e[1]||(e[1]=u=>n.date_from=u),type:"date",placeholder:"开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",shortcuts:g,style:{width:"150px"}},null,8,["modelValue"]),e[6]||(e[6]=s("span",{class:"text-sm text-gray-500"},"至",-1)),t(E,{modelValue:n.date_to,"onUpdate:modelValue":e[2]||(e[2]=u=>n.date_to=u),type:"date",placeholder:"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",shortcuts:g,style:{width:"150px"}},null,8,["modelValue"])]),s("div",ee,[t(N,{type:"primary",onClick:d},{default:a(()=>e[7]||(e[7]=[x("查询",-1)])),_:1,__:[7]}),t(N,{onClick:p},{default:a(()=>e[8]||(e[8]=[x("重置",-1)])),_:1,__:[8]})])])]),_:1}),l.value?q((y(),F(v,{key:0},{header:a(()=>[s("div",te,[s("span",se,"统计概览 - "+m(l.value.website.name),1),t(D,{type:"info",size:"small"},{default:a(()=>[x(" 统计周期: "+m(l.value.period.from)+" ~ "+m(l.value.period.to),1)]),_:1})])]),default:a(()=>[s("div",ae,[t(Y,{"content-position":"left"},{default:a(()=>e[9]||(e[9]=[s("span",{class:"text-base font-semibold"},"任务统计",-1)])),_:1,__:[9]}),t(V,{gutter:20},{default:a(()=>[t(i,{span:6},{default:a(()=>[t(f,{title:"总任务数",value:l.value.summary.total_tasks,"value-style":"color: #409EFF"},null,8,["value"])]),_:1}),t(i,{span:6},{default:a(()=>[t(f,{title:"已完成任务",value:l.value.summary.completed_tasks,"value-style":"color: #67C23A"},null,8,["value"])]),_:1}),t(i,{span:6},{default:a(()=>[t(f,{title:"失败任务",value:l.value.summary.failed_tasks,"value-style":"color: #F56C6C"},null,8,["value"])]),_:1}),t(i,{span:6},{default:a(()=>[s("div",le,[e[10]||(e[10]=s("div",{class:"text-gray-500 text-sm mb-2"},"任务成功率",-1)),s("div",oe,m(l.value.summary.total_tasks>0?w(l.value.summary.completed_tasks/l.value.summary.total_tasks):"0%"),1)])]),_:1})]),_:1})]),s("div",ne,[t(Y,{"content-position":"left"},{default:a(()=>e[11]||(e[11]=[s("span",{class:"text-base font-semibold"},"链接统计",-1)])),_:1,__:[11]}),t(V,{gutter:20},{default:a(()=>[t(i,{span:8},{default:a(()=>[t(f,{title:"总爬取链接数",value:l.value.summary.total_links_crawled,"value-style":"color: #409EFF"},null,8,["value"])]),_:1}),t(i,{span:8},{default:a(()=>[t(f,{title:"新增链接数",value:l.value.summary.new_links_found,"value-style":"color: #E6A23C"},null,8,["value"])]),_:1}),t(i,{span:8},{default:a(()=>[s("div",re,[e[12]||(e[12]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均新增率",-1)),s("div",de,m(l.value.summary.total_links_crawled>0?w(l.value.summary.new_links_found/l.value.summary.total_links_crawled):"0%"),1)])]),_:1})]),_:1})]),s("div",null,[t(Y,{"content-position":"left"},{default:a(()=>e[13]||(e[13]=[s("span",{class:"text-base font-semibold"},"质量统计",-1)])),_:1,__:[13]}),t(V,{gutter:20},{default:a(()=>[t(i,{span:12},{default:a(()=>[t(v,{shadow:"never",class:"text-center"},{default:a(()=>[s("div",ie,[e[14]||(e[14]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均有效率",-1)),s("div",ue,m(w(l.value.summary.avg_valid_rate)),1)]),t(B,{percentage:l.value.summary.avg_valid_rate*100,"stroke-width":20,class:"mt-4"},null,8,["percentage"]),t(D,{type:"info",size:"small",class:"mt-2"},{default:a(()=>e[15]||(e[15]=[x(" 有效链接占总链接的比例 ",-1)])),_:1,__:[15]})]),_:1})]),_:1}),t(i,{span:12},{default:a(()=>[t(v,{shadow:"never",class:"text-center"},{default:a(()=>[s("div",_e,[e[16]||(e[16]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均精准率",-1)),s("div",me,m(w(l.value.summary.avg_precision_rate)),1)]),t(B,{percentage:l.value.summary.avg_precision_rate*100,"stroke-width":20,color:"#409EFF",class:"mt-4"},null,8,["percentage"]),t(D,{type:"info",size:"small",class:"mt-2"},{default:a(()=>e[17]||(e[17]=[x(" 成功下载占有效链接的比例 ",-1)])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})])]),_:1})),[[U,c.value]]):c.value?G("",!0):(y(),F(T,{key:1,description:"请选择网站查看统计数据"}))])}}}),xe=Q(ce,[["__scopeId","data-v-f80fbb35"]]);export{xe as default};
