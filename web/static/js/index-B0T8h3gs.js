var V=(E,g,n)=>new Promise((c,a)=>{var b=d=>{try{_(n.next(d))}catch(p){a(p)}},k=d=>{try{_(n.throw(d))}catch(p){a(p)}},_=d=>d.done?c(d.value):Promise.resolve(d.value).then(b,k);_((n=n.apply(E,g)).next())});import{g as U}from"./statistics-CaG0pjx3.js";import{g as W}from"./websites-BHTta-M-.js";import{v as H,r as F,h as R,i as j,c as B,o as x,J as t,I as q,V as M,H as G,S as l,b as s,G as r,M as J,N as K,T as y,aa as P,R as m,ax as S,_ as Q}from"./index-Bt5xf_d8.js";const $={class:"welcome"},O={class:"flex flex-wrap items-center gap-4"},X={class:"flex items-center gap-2"},Z={class:"flex items-center gap-2"},ee={class:"flex items-center gap-2"},te={class:"flex items-center justify-between"},se={class:"text-base font-semibold"},le={class:"mb-6"},ae={class:"text-center"},oe={class:"text-2xl font-semibold",style:{color:"#67C23A"}},ne={class:"mb-6"},re={class:"text-center"},de={class:"text-2xl font-semibold",style:{color:"#E6A23C"}},ie={class:"mb-4"},ue={class:"text-4xl font-semibold",style:{color:"#67C23A"}},_e={class:"mb-4"},me={class:"text-4xl font-semibold",style:{color:"#409EFF"}},ce=H({name:"Welcome",__name:"index",setup(E){const g=F([]),n=R({website_id:"",date_from:"",date_to:""}),c=F(!1),a=F(null),b=[{text:"最近7天",value:()=>{const o=new Date,e=new Date;return e.setDate(e.getDate()-7),[e,o]}},{text:"最近30天",value:()=>{const o=new Date,e=new Date;return e.setDate(e.getDate()-30),[e,o]}},{text:"最近3个月",value:()=>{const o=new Date,e=new Date;return e.setMonth(e.getMonth()-3),[e,o]}}],k=()=>V(null,null,function*(){try{const o=yield W({status:"active"});o.success&&(g.value=o.data,o.data.length>0&&(n.website_id=o.data[0].id,_()))}catch(o){console.error("加载网站列表失败",o)}}),_=()=>V(null,null,function*(){if(!n.website_id){S.warning("请选择网站");return}c.value=!0;try{const o=yield U(n);o.success&&(a.value=o.data)}catch(o){S.error("加载统计数据失败")}finally{c.value=!1}}),d=()=>{_()},p=()=>{n.date_from="",n.date_to="",_()},w=o=>`${(o*100).toFixed(2)}%`;return j(()=>{k()}),(o,e)=>{const v=r("el-card"),z=r("el-option"),I=r("el-select"),h=r("el-date-picker"),N=r("el-button"),D=r("el-text"),Y=r("el-divider"),f=r("el-statistic"),i=r("el-col"),C=r("el-row"),A=r("el-progress"),L=r("el-empty"),T=P("loading");return x(),B("div",$,[t(v,{class:"mb-4"},{default:l(()=>e[3]||(e[3]=[s("div",{class:"text-center"},[s("h1",{class:"text-3xl font-bold text-gray-800 mb-2"},"欢迎使用 FETCHLINK"),s("p",{class:"text-gray-500"},"网页链接爬虫系统")],-1)])),_:1,__:[3]}),t(v,{class:"mb-4"},{default:l(()=>[s("div",O,[s("div",X,[e[4]||(e[4]=s("span",{class:"text-sm whitespace-nowrap"},"网站",-1)),t(I,{modelValue:n.website_id,"onUpdate:modelValue":e[0]||(e[0]=u=>n.website_id=u),placeholder:"请选择网站",style:{width:"200px"}},{default:l(()=>[(x(!0),B(J,null,K(g.value,u=>(x(),M(z,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),s("div",Z,[e[5]||(e[5]=s("span",{class:"text-sm whitespace-nowrap"},"日期范围",-1)),t(h,{modelValue:n.date_from,"onUpdate:modelValue":e[1]||(e[1]=u=>n.date_from=u),type:"date",placeholder:"开始日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",shortcuts:b,style:{width:"150px"}},null,8,["modelValue"]),e[6]||(e[6]=s("span",{class:"text-sm text-gray-500"},"至",-1)),t(h,{modelValue:n.date_to,"onUpdate:modelValue":e[2]||(e[2]=u=>n.date_to=u),type:"date",placeholder:"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",shortcuts:b,style:{width:"150px"}},null,8,["modelValue"])]),s("div",ee,[t(N,{type:"primary",onClick:d},{default:l(()=>e[7]||(e[7]=[y("查询",-1)])),_:1,__:[7]}),t(N,{onClick:p},{default:l(()=>e[8]||(e[8]=[y("重置",-1)])),_:1,__:[8]})])])]),_:1}),a.value?q((x(),M(v,{key:0},{header:l(()=>[s("div",te,[s("span",se,"统计概览 - "+m(a.value.website.name),1),t(D,{type:"info",size:"small"},{default:l(()=>[y(" 统计周期: "+m(a.value.period.from)+" ~ "+m(a.value.period.to),1)]),_:1})])]),default:l(()=>[s("div",le,[t(Y,{"content-position":"left"},{default:l(()=>e[9]||(e[9]=[s("span",{class:"text-base font-semibold"},"任务统计",-1)])),_:1,__:[9]}),t(C,{gutter:20},{default:l(()=>[t(i,{span:6},{default:l(()=>[t(f,{title:"总任务数",value:a.value.summary.total_tasks,"value-style":"color: #409EFF"},null,8,["value"])]),_:1}),t(i,{span:6},{default:l(()=>[t(f,{title:"已完成任务",value:a.value.summary.completed_tasks,"value-style":"color: #67C23A"},null,8,["value"])]),_:1}),t(i,{span:6},{default:l(()=>[t(f,{title:"失败任务",value:a.value.summary.failed_tasks,"value-style":"color: #F56C6C"},null,8,["value"])]),_:1}),t(i,{span:6},{default:l(()=>[s("div",ae,[e[10]||(e[10]=s("div",{class:"text-gray-500 text-sm mb-2"},"任务成功率",-1)),s("div",oe,m(a.value.summary.total_tasks>0?w(a.value.summary.completed_tasks/a.value.summary.total_tasks):"0%"),1)])]),_:1})]),_:1})]),s("div",ne,[t(Y,{"content-position":"left"},{default:l(()=>e[11]||(e[11]=[s("span",{class:"text-base font-semibold"},"链接统计",-1)])),_:1,__:[11]}),t(C,{gutter:20},{default:l(()=>[t(i,{span:8},{default:l(()=>[t(f,{title:"总爬取链接数",value:a.value.summary.total_links_crawled,"value-style":"color: #409EFF"},null,8,["value"])]),_:1}),t(i,{span:8},{default:l(()=>[t(f,{title:"新增链接数",value:a.value.summary.new_links_found,"value-style":"color: #E6A23C"},null,8,["value"])]),_:1}),t(i,{span:8},{default:l(()=>[s("div",re,[e[12]||(e[12]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均新增率",-1)),s("div",de,m(a.value.summary.total_links_crawled>0?w(a.value.summary.new_links_found/a.value.summary.total_links_crawled):"0%"),1)])]),_:1})]),_:1})]),s("div",null,[t(Y,{"content-position":"left"},{default:l(()=>e[13]||(e[13]=[s("span",{class:"text-base font-semibold"},"质量统计",-1)])),_:1,__:[13]}),t(C,{gutter:20},{default:l(()=>[t(i,{span:12},{default:l(()=>[t(v,{shadow:"never",class:"text-center"},{default:l(()=>[s("div",ie,[e[14]||(e[14]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均有效率",-1)),s("div",ue,m(w(a.value.summary.avg_valid_rate)),1)]),t(A,{percentage:a.value.summary.avg_valid_rate*100,"stroke-width":20,class:"mt-4"},null,8,["percentage"]),t(D,{type:"info",size:"small",class:"mt-2"},{default:l(()=>e[15]||(e[15]=[y(" 有效链接占总链接的比例 ",-1)])),_:1,__:[15]})]),_:1})]),_:1}),t(i,{span:12},{default:l(()=>[t(v,{shadow:"never",class:"text-center"},{default:l(()=>[s("div",_e,[e[16]||(e[16]=s("div",{class:"text-gray-500 text-sm mb-2"},"平均精准率",-1)),s("div",me,m(w(a.value.summary.avg_precision_rate)),1)]),t(A,{percentage:a.value.summary.avg_precision_rate*100,"stroke-width":20,color:"#409EFF",class:"mt-4"},null,8,["percentage"]),t(D,{type:"info",size:"small",class:"mt-2"},{default:l(()=>e[17]||(e[17]=[y(" 成功下载占有效链接的比例 ",-1)])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})])]),_:1})),[[T,c.value]]):c.value?G("",!0):(x(),M(L,{key:1,description:"请选择网站查看统计数据"}))])}}}),ye=Q(ce,[["__scopeId","data-v-054c573f"]]);export{ye as default};
